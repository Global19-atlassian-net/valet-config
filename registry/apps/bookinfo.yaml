name: bookinfo
values:
  Domain: valet-testing-bookinfo.corp.solo.io
  VirtualServiceName: bookinfo
  Namespace: bookinfo
  UpstreamName: bookinfo-productpage-9080
  UpstreamNamespace: gloo-system
resources:
  - namespace:
      name: bookinfo
      labels:
        istio-injection: enabled
  - path: registry/files/bookinfo-appstate.yaml
  - condition:
      type: ApplicationState
      name: bookinfo-demo
      namespace: sm-marketplace
      jsonpath: '{.spec.installationState.status}'
      value: INSTALLED
      timeout: 120s
  - template:
      path: registry/templates/virtual-service-ssl.yaml
  - template:
      path: registry/templates/cert.yaml
  - dnsEntry:
      hostedZone: corp.solo.io.
      service:
        namespace: gloo-system
        name: gateway-proxy-v2
  - patch:
      path: registry/patches/bookinfo-upstream-ssl.yaml
      kubeType: upstream
      name: bookinfo-productpage-9080
      namespace: gloo-system
      patchType: merge
  - patch:
      path: registry/patches/gateway-proxy-deployment-ssl.yaml
      kubeType: deployment
      name: gateway-proxy-v2
      namespace: gloo-system
      patchType: strategic